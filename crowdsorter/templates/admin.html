{% extends "layout.html" %}

{% block title %}{{ super() }} | {{ collection['name'] }} | Admin{% endblock %}

{% block content %}
{{ super() }}
    <div class="jumbotron text-center">
        <h2 class="title">{{ collection['name'] }}</h2>
    </div>

    {% include "flashes.html" %}

    <div class="container">
        <div class="col-sm-8 col-sm-offset-2">

            <div class="row bottom-buffer">
                <p>
                    This is the admin page for the
                    <code>{{ collection['name'] }}</code>
                    collection.
                    Keep this URL private and do not share it with others.
                    You will need to return to this page to make additional changes to this collection.
                </p>
            </div>

            <div class="row">
                <form method="post">
                    <div class="form-group">
                        <label for="email">Admin Email</label>
                        <input type="text" class="form-control" id="email" name="email" value="{{ collection['owner'] }}" placeholder="Your Email Address">
                    </div>
                    <div class="center top-buffer">
                        <input type="submit" class="btn btn-primary" value="Send Me a Link"></input>
                    </div>
                </form>
            </div>

        </div>
    </div>

    <div class="container-fluid">
        <hr>
    </div>

    <div class="container">
        <div class="col-sm-8 col-sm-offset-2">

            <h3 class="section center">Settings</h3>

            <div class="row">
                <form method="post">
                    <div class="form-group">
                        <label for="collection-name">Full Name</label>
                        <input type="text" class="form-control" id="collection-name" name="name" value="{{ collection['name'] }}">
                    </div>
                    <label for="collection-code">Short Code</label>
                    <div class="form-group input-group">
                        <span class="input-group-addon" id="basic-addon1">
                            {{ request.url_root }}
                        </span>
                        <input type="text" class="form-control" id="collection-code" name="code" value="{{ collection['code'] }}" aria-describedby="basic-addon1">
                    </div>
                    <div class="form-group">
                        <label>Options</label>
                        <div class="checkbox">
                            <label>
                                <input type="checkbox" name="public" {{ "" if collection['private'] else "checked=true" }}>
                                Allow sharing and display in search results
                            </label>
                        </div>
                        <div class="checkbox">
                            <label>
                                <input type="checkbox" name="unlocked" {{ "" if collection['locked'] else "checked=true" }}>
                                Allow anyone to add items to this collection
                            </label>
                        </div>
                    </div>
                    <div class="row center top-buffer">
                        <input type="submit" class="btn btn-primary" name="save" value="Save Changes"></input>
                    </div>
                </form>
            </div>

        </div>
    </div>

    <div class="container-fluid">
        <hr>
    </div>

    <div class="container">
        <div class="col-sm-8 col-sm-offset-2">

            <h3 class="section center">Items</h3>

            <div class="row">
                {% for item in collection['_embedded']['items'] %}
                <form method="post" class="input-group input-group-lg bottom-buffer">
                    <div class="form-control input-lg">
                    {% if item['ref_url'] %}
                        <a href="{{ item['ref_url'] }}" target="_blank">{{ item['name'] }}</a>
                    {% elif item['image_url'] %}
                        <a href="{{ item['image_url'] }}" target="_blank">{{ item['name'] }}</a>
                    {% else %}
                        {{ item['name'] }}
                    {% endif %}
                    </div>
                    <input type=hidden value="{{ item['name'] }}" name="remove"/>
                    <span class="input-group-btn">
                        <a href="{{ url_for('items.detail', key=item['key']) }}" target="_blank" role="button" class="btn btn-primary" title="Edit this item">
                            <span class="glyphicon glyphicon-edit"></span>
                        </a>
                        <button type="submit" class="btn btn-danger" title="Remove this item">
                            <span class="glyphicon glyphicon-minus-sign"></span>
                        </button>
                    </span>
                </form>
                {% endfor %}
            </div>

            <div class="row">
                <form id="add-item-form" method="post" class="input-group input-group-lg">
                    <input type="text" class="form-control input-lg" name="add" placeholder="New Item Name">
                    <span class="input-group-btn">
                        <button type="submit" class="btn btn-success" title="Add an item">
                            <span class="glyphicon glyphicon-plus-sign"></span>
                        </button>
                    </span>
                </form>
            </div>

            <div class="row center top-buffer">
                <form method="post" target="_blank">
                    <input type="submit" class="btn btn-default" name="view" value="View Collection"/>
                </form>
                <a class="btn btn-default" href="/{{ collection['code'] }}/results.csv" role="button">
                    <span class="glyphicon glyphicon-download"></span>
                    &nbsp;
                    Download Results
                </a>
            </div>

        </div>
    </div>

    <div class="container-fluid">
        <hr>
    </div>

    <div class="container">
        <div class="col-sm-8 col-sm-offset-2">

            <h3 class="section center">Danger Zone</h3>

            <div class="row center">
                <form method="post">
                    <input type="submit" class="btn btn-default" name="clear" value="Clear Votes"/>
                    <input type="submit" class="btn btn-danger" name="delete" value="Delete Collection"/>
                </form>
            </div>

        </div>
    </div>

    {% include "footer.html" %}
{% endblock %}
