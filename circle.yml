version: 2

executorType: docker

containerInfo:
  - image: python:3.6.1
  - image: mongo:3.4.4

stages:
  build:
    workDir: /home/ubuntu/crowdsorter
    environment:
      PIPENV_NOSPIN: true
    steps:
      - type: checkout
      - type: shell
        command: pip install pipenv~=5.0
      - type: shell
        command: make doctor
      - type: shell
        command: make install
      - type: shell
        command: make check
      - type: shell
        command: make test
        # TODO: get reports working with CircleCI 2.0
